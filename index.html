<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bakery Moon Sweet</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-amber-50">
<div id="root"></div>

<script type="text/babel">
const {useState,useEffect} = React;

function useLocal(key,init){
  const [val,setVal]=useState(()=>JSON.parse(localStorage.getItem(key)||'null')??init);
  useEffect(()=>localStorage.setItem(key,JSON.stringify(val)),[key,val]);
  return [val,setVal];
}

// ---------------- MOCK DATA -----------------
const SAMPLE_PRODUCTS = [
  {id:'1',name:'Croissant',price:60,category:'Pastry',desc:'Buttery flaky croissant',rating:4.5, image:'https://images.unsplash.com/photo-1567620905732-2d1dc7efbdab?q=80&w=1974&auto=format&fit=crop'},
  {id:'2',name:'Chocolate Cake',price:120,category:'Cake',desc:'Rich chocolate sponge with ganache',rating:5, image:'https://images.unsplash.com/photo-1578985545063-6f6f96ac3383?q=80&w=1974&auto=format&fit=crop'},
  {id:'3',name:'Cappuccino',price:80,category:'Beverage',desc:'Espresso with steamed milk',rating:4.2, image:'https://images.unsplash.com/photo-1541167710266-9b4344c80321?q=80&w=1974&auto=format&fit=crop'},
  {id:'4',name:'Macaron',price:30,category:'Pastry',desc:'Sweet meringue-based confection',rating:4.8, image:'https://images.unsplash.com/photo-1627889104193-4a1715450e18?q=80&w=1974&auto=format&fit=crop'},
  {id:'5',name:'Blueberry Muffin',price:50,category:'Pastry',desc:'Moist muffin with fresh blueberries',rating:4.3, image:'https://images.unsplash.com/photo-1621245037520-4e314643ce4e?q=80&w=1974&auto=format&fit=crop'}
];

// --------------- Components -----------------
function Header({cartCount,user,onNav,onCart}){
  return (
    <header className="bg-amber-100 border-b p-4 flex justify-between items-center">
      <h1 className="font-bold text-xl">Bakery Moon Sweet</h1>
      <div className="flex gap-4 items-center">
        <button onClick={()=>onNav('home')}>Home</button>
        <button onClick={()=>onNav('menu')}>Menu</button>
        <button onClick={()=>onNav('profile')}>Profile</button>
        <button onClick={()=>onNav('admin')}>Admin</button>
        <button className="bg-amber-600 text-white px-3 py-1 rounded" onClick={onCart}>Cart ({cartCount})</button>
        <span className="text-sm text-gray-700">{user ? `Hi, ${user}` : ''}</span>
      </div>
    </header>
  );
}

function SearchBar({onChange}){
  return (
    <input
      className="border p-2 w-full rounded mb-4"
      placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤..."
      onChange={e=>onChange(e.target.value)}
    />
  );
}

function ProductCard({p,onAdd,onFav,favs,onReview}){
  const fav = favs.includes(p.id);
  return (
    <div className="border rounded-lg p-4 flex flex-col shadow-sm hover:shadow-lg transition-shadow bg-white">
      {p.image && <img src={p.image} alt={p.name} className="w-full h-32 object-cover rounded-md mb-2"/>}
      <div className="flex justify-between">
        <div className="font-semibold text-lg">{p.name}</div>
        <button onClick={()=>onFav(p.id)}>{fav?'‚ù§Ô∏è':'ü§ç'}</button>
      </div>
      <div className="text-xs text-gray-600">{p.category}</div>
      <div className="mt-1 text-sm">{p.desc}</div>
      <div className="mt-1 text-yellow-600 text-sm">‚≠ê {p.rating.toFixed(1)}</div>
      <div className="flex justify-between mt-3 items-center">
        <div className="font-bold text-lg">‡∏ø{p.price}</div>
        <button onClick={()=>onAdd(p)} className="bg-amber-600 text-white px-2 py-1 rounded">Add</button>
      </div>
      <button onClick={()=>onReview(p)} className="text-xs mt-1 underline">‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</button>
    </div>
  );
}

function Home({products, onAdd, onFav, favs, onReview}) {
    const featured = products.slice(0, 4);
    return (
        <div className="p-4">
            <div className="relative h-64 bg-cover bg-center rounded-lg shadow-lg" style={{backgroundImage: "url('https://images.unsplash.com/photo-1542826189-9a706b8720ca?q=80&w=1974&auto=format&fit=crop')"}}>
                <div className="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center rounded-lg">
                    <h2 className="text-white text-4xl font-bold drop-shadow-lg text-center">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà Bakery Moon Sweet</h2>
                </div>
            </div>

            <div className="mt-8">
                <h3 className="font-bold text-2xl mb-4 text-center text-amber-800">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>
                <div className="grid md:grid-cols-4 gap-4">
                    {featured.map(p => <ProductCard key={p.id} p={p} onAdd={onAdd} onFav={onFav} favs={favs} onReview={onReview}/>)}
                </div>
            </div>

            <div className="mt-8 bg-amber-200 p-6 rounded-lg shadow-md text-center">
                <h3 className="font-bold text-2xl text-amber-800">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©!</h3>
                <p className="mt-2 text-amber-700 text-lg">‡∏£‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 10% ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏£‡∏ö 500 ‡∏ö‡∏≤‡∏ó</p>
                <p className="font-semibold text-amber-900 mt-1">‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡πâ‡∏î: SWEET10</p>
            </div>
            
            <div className="mt-8 text-center text-gray-700">
                <h3 className="font-bold text-2xl text-amber-800">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</h3>
                <p className="mt-2 text-lg">
                    ‡πÄ‡∏£‡∏≤‡∏≠‡∏ö‡∏Ç‡∏ô‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏™‡πà‡πÉ‡∏à‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô
                    ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏°‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏´‡∏≠‡∏°‡∏´‡∏ß‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ô‡∏∏‡πà‡∏°‡∏•‡∏∞‡∏°‡∏∏‡∏ô
                    ‡∏°‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏µ‡πÜ ‡∏Å‡∏±‡∏ö‡πÄ‡∏ö‡πÄ‡∏Å‡∏≠‡∏£‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏™‡∏¥‡∏Ñ‡∏£‡∏±‡∏ö/‡∏Ñ‡πà‡∏∞!
                </p>
            </div>
        </div>
    );
}

function Menu({products,onAdd,onFav,favs,onReview}){
  const [filter,setFilter]=useState('');
  const [search,setSearch]=useState('');
  const cats=['All',...new Set(products.map(p=>p.category))];
  const shown = products.filter(p=>
    (filter===''||filter==='All'||p.category===filter) &&
    p.name.toLowerCase().includes(search.toLowerCase())
  );
  return (
    <div className="p-4">
      <SearchBar onChange={setSearch}/>
      <select value={filter} onChange={e=>setFilter(e.target.value)} className="border p-1 mb-4">
        {cats.map(c=><option key={c}>{c}</option>)}
      </select>
      <div className="grid md:grid-cols-3 gap-4">
        {shown.map(p=><ProductCard key={p.id} p={p} onAdd={onAdd} onFav={onFav} favs={favs} onReview={onReview}/>)}
      </div>
    </div>
  );
}

function Cart({items,onQty,onRemove,onCheckout,coupon,onCoupon,onClose}){
  const subtotal = items.reduce((s,i)=>s+i.price*i.qty,0);
  const discount = coupon==='BAKE10'? subtotal*0.1 : 0;
  const total = subtotal - discount;
  return (
    <div className="fixed top-20 right-4 w-80 bg-white border p-4 rounded shadow z-50">
      <div className="flex justify-between mb-2">
        <h3 className="font-semibold">Cart</h3>
        <button onClick={onClose}>X</button>
      </div>
      {items.map(i=>
        <div key={i.id} className="flex justify-between mb-2">
          <span>{i.name}</span>
          <div className="flex gap-1 items-center">
            <button onClick={()=>onQty(i.id,i.qty-1)}>-</button>
            {i.qty}
            <button onClick={()=>onQty(i.id,i.qty+1)}>+</button>
            <button onClick={()=>onRemove(i.id)} className="text-red-500">x</button>
          </div>
        </div>
      )}
      <input className="border p-1 w-full mb-2" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á" value={coupon} onChange={e=>onCoupon(e.target.value)}/>
      <div>Subtotal: ‡∏ø{subtotal}</div>
      {discount>0 && <div className="text-green-600">Discount: -‡∏ø{discount}</div>}
      <div className="font-bold">Total: ‡∏ø{total}</div>
      <button className="w-full bg-amber-600 text-white py-1 mt-2 rounded" onClick={()=>onCheckout(total)}>Checkout</button>
    </div>
  );
}

function Profile({orders,favs, onCancelOrder}){
  return (
    <div className="p-4">
      <h2 className="font-bold text-lg mb-2">Profile</h2>
      <h3 className="font-semibold mt-2">Favorites</h3>
      <ul className="list-disc ml-5">
        {favs.length?favs.map(f=><li key={f}>{f}</li>):<li>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î</li>}
      </ul>
      <h3 className="font-semibold mt-4">Orders</h3>
      {orders.length===0 && <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</p>}
      {orders.map(o=>(
        <div key={o.id} className="border p-2 my-1 flex justify-between items-center">
          <div>
            <div>#{o.id} ‚Ä¢ ‡∏ø{o.total} ‚Ä¢ {o.method}</div>
          </div>
          <button
            onClick={() => onCancelOrder(o.id)}
            className="bg-red-500 text-white text-xs px-2 py-1 rounded hover:bg-red-600"
          >
            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
          </button>
        </div>
      ))}
    </div>
  );
}

function Admin({products,onAdd,onDel}){
  const [form,setForm]=useState({name:'',price:'',category:'',desc:''});
  return (
    <div className="p-4">
      <h2 className="font-bold text-lg mb-2">Admin Panel</h2>
      <div className="border p-3 mb-4 rounded">
        <input className="border p-1 mr-1" placeholder="Name" value={form.name} onChange={e=>setForm({...form,name:e.target.value})}/>
        <input className="border p-1 mr-1 w-20" placeholder="Price" value={form.price} onChange={e=>setForm({...form,price:e.target.value})}/>
        <input className="border p-1 mr-1" placeholder="Category" value={form.category} onChange={e=>setForm({...form,category:e.target.value})}/>
        <input className="border p-1 mr-1" placeholder="Desc" value={form.desc} onChange={e=>setForm({...form,desc:e.target.value})}/>
        <button className="bg-green-500 text-white px-2 py-1 rounded" onClick={()=>{
          if(form.name&&form.price){
            onAdd({...form,price:Number(form.price),id:Date.now().toString(),rating:0});
            setForm({name:'',price:'',category:'',desc:''});
          }
        }}>Add</button>
      </div>
      <h3 className="font-semibold">Current Products</h3>
      {products.map(p=>(
        <div key={p.id} className="flex justify-between border-b py-1">
          {p.name} ‡∏ø{p.price}
          <button className="text-red-600" onClick={()=>onDel(p.id)}>Delete</button>
        </div>
      ))}
    </div>
  );
}

// ---------------- Main App ------------------
function App(){
  const [page,setPage]=useLocal('page','home');
  const [products,setProducts]=useLocal('products',SAMPLE_PRODUCTS);
  const [cart,setCart]=useLocal('cart',[]);
  const [orders,setOrders]=useLocal('orders',[]);
  const [favs,setFavs]=useLocal('favs',[]);
  const [user,setUser]=useLocal('user',null);
  const [coupon,setCoupon]=useState('');
  const [cartOpen,setCartOpen]=useState(false);

  function addCart(p){
    setCart(c=>{
      const f=c.find(i=>i.id===p.id);
      return f?c.map(i=>i.id===p.id?{...i,qty:i.qty+1}:i):[...c,{...p,qty:1}];
    });
    setCartOpen(true);
  }

  const qtyUpdate=(id,q)=>setCart(c=>c.map(i=>i.id===id?{...i,qty:Math.max(1,q)}:i));
  const removeItem=id=>setCart(c=>c.filter(i=>i.id!==id));
  const toggleFav=id=>setFavs(f=>f.includes(id)?f.filter(x=>x!==id):[...f,id]);
  
  const checkout=total=>{
    const method = prompt("Payment method (PromptPay/COD)?","PromptPay");
    setOrders(o=>[{id:Date.now(),total,method:method||'PromptPay'},...o]);
    setCart([]);
    alert("Order placed!");
    setCartOpen(false);
    setPage('profile');
  };
  
  const cancelOrder = (orderId) => {
    if (window.confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?")) {
      setOrders(currentOrders => currentOrders.filter(o => o.id !== orderId));
      alert("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
    }
  };

  if(!user){
    const name = prompt("‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô");
    if(name) setUser(name);
  }

  return (
    <div className="min-h-screen p-4 max-w-6xl mx-auto">
      <Header cartCount={cart.reduce((s,i)=>s+i.qty,0)} user={user} onNav={setPage} onCart={()=>setCartOpen(true)}/>
      {page==='home' && <Home products={products} onAdd={addCart} onFav={toggleFav} favs={favs} />}
      {page==='menu' && <Menu products={products} onAdd={addCart} onFav={toggleFav} favs={favs}/>}
      {page==='profile' && <Profile orders={orders} favs={favs} onCancelOrder={cancelOrder}/>}
      {page==='admin' && <Admin products={products} onAdd={p=>setProducts(ps=>[...ps,p])} onDel={id=>setProducts(ps=>ps.filter(x=>x.id!==id))}/>}
      {cartOpen && <Cart items={cart} onQty={qtyUpdate} onRemove={removeItem} onCheckout={checkout}
                        coupon={coupon} onCoupon={setCoupon} onClose={()=>setCartOpen(false)}/>}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>